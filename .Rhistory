,m_rating.nxgrowth
,m_rating2xgrowth
,m_rating2xgrowth2
,m_nativexgrowth2
,m_nativepgrowth
,m_nativep
,m_growthp)
anova(m_growth, mV)
Anova(m_growth)
summary(m_growth)
#mall
slopes <- emtrends(m_growth, ~ Growth_Habit, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
# geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggsave("slopes_growth_pred.jpg")
# Check assumptions
# How to filter for species found in multiple populations
unique(repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Scientific_Name == "Avena barbata"),"Population"])
repro_fill_hi_n_narm %>%
group_by(Scientific_Name) %>%
count(Population)
repro_temp <- unique(repro_fill_hi_n_narm[,c("Scientific_Name","Population")])
repro_temp_2 <- repro_temp %>%
group_by(Scientific_Name) %>%
count() %>%
filter(n > 1)
mults <- repro_temp_2$Scientific_Name
repro_pop <- repro_fill_hi_n_narm %>%
filter(Scientific_Name %in% c(mults))
rm(
repro_temp
, repro_temp_2
, mults
)
# Graph, model, and analyze
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Scientific_Name, data = repro_pop))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Scientific_Name,
data = repro_pop)
slopes <- emtrends(mod, ~ Population*Scientific_Name, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Scientific_Name, y = Veg_Mass_ln.trend,
fill = Population
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour='black', alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
theme(
axis.text.x = element_text(face = "italic", angle = 45, vjust = 1, hjust = 1)) +
scale_fill_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
labs(x = "Species",
y = "VR Slope",
fill = "")
ggsave("slopes_popxspp.jpg")
# Add in aridity index
# Make Grass and Forb panel
str(repro_pop)
m0 <- glm(total_fl_mass_ln ~ 1, family = gaussian, data = repro_pop)
m1 <- glmer(total_fl_mass_ln ~ 1 + (1|Scientific_Name), family = gaussian, data = repro_pop)
m2 <- glmer(total_fl_mass_ln ~ 1 + (1|Block/Shelter/Plot), family = gaussian, data = repro_pop)
m3 <- glmer(total_fl_mass_ln ~ 1 + (1|Block) + (1|Treatment), family = gaussian, data = repro_pop)
m4 <- glmer(total_fl_mass_ln ~ 1 + (1|Block/Shelter/Plot) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m5 <- glmer(total_fl_mass_ln ~ 1 + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m6 <- glmer(total_fl_mass_ln ~ 1 + (1|Block) + (1|Scientific_Name), family = gaussian, data = repro_pop)
ICtab(m0,m1,m2,m3,m4,m5,m6)
m5 <- glmer(total_fl_mass_ln ~ 1 + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
mV <- glmer(total_fl_mass_ln ~ Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_native <- glmer(total_fl_mass_ln ~ Native_Status*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_rating <- glmer(total_fl_mass_ln ~ Rating*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_growth <- glmer(total_fl_mass_ln ~ Growth_Habit*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_precip <- glmer(total_fl_mass_ln ~ Precip_mm*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_pdif <- glmer(total_fl_mass_ln ~ precip_dif*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_rating.n <- glmer(total_fl_mass_ln ~ rating.n*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_nativexgrowth <- glmer(total_fl_mass_ln ~ Native_Status*Growth_Habit*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_ratingxgrowth <- glmer(total_fl_mass_ln ~ Rating*Growth_Habit*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_nativexpop <- glmer(total_fl_mass_ln ~ Native_Status*Population*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_ratingxpop <- glmer(total_fl_mass_ln ~ Rating*Population*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_growthxpop <- glmer(total_fl_mass_ln ~ Growth_Habit*Population*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_nativexprecip <- glmer(total_fl_mass_ln ~ Native_Status*Precip_mm*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_ratingxprecip <- glmer(total_fl_mass_ln ~ Rating*Precip_mm*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_growthxprecip <- glmer(total_fl_mass_ln ~ Growth_Habit*Precip_mm*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_rating.nxpop <- glmer(total_fl_mass_ln ~ rating.n*Population*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_rating.nxgrowth <- glmer(total_fl_mass_ln ~ rating.n*Growth_Habit*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_rating.nxprecip <- glmer(total_fl_mass_ln ~ rating.n*Precip_mm*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_spei <- glmer(total_fl_mass_ln ~ spei_avg*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_speixgrowth <- glmer(total_fl_mass_ln ~ spei_avg*Growth_Habit*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_speixnative <- glmer(total_fl_mass_ln ~ spei_avg*Native_Status*Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_spei_p <- glmer(total_fl_mass_ln ~ spei_avg+Veg_Mass_ln + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_spei_p_xnative <- glmer(total_fl_mass_ln ~ spei_avg+Veg_Mass_ln*Native_Status + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
m_spei_p_xgrowth <- glmer(total_fl_mass_ln ~ spei_avg+Veg_Mass_ln*Growth_Habit + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_pop)
ICtab(m5
,mV
,m_native
,m_rating
,m_growth
,m_growthxpop
,m_growthxprecip
,m_nativexgrowth
,m_nativexpop
,m_nativexprecip
,m_pdif
,m_precip
,m_ratingxgrowth
,m_ratingxpop
,m_ratingxprecip
,m_rating.n
,m_rating.nxgrowth
,m_rating.nxpop
,m_rating.nxprecip
,m_spei
,m_speixgrowth
,m_speixnative
,m_spei_p
,m_spei_p_xnative
,m_spei_p_xgrowth)
# m_spei_p_xnative, m_spei_p_xgrowth are the best. The growth/native term is effectively the same because all the grasses are non native and most of the forbs are native
anova(m_spei_p_xgrowth, m5)
anova(m_spei_p_xgrowth, mV)
slopes <- emtrends(m_spei_p_xgrowth, ~ Growth_Habit + spei_avg, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
summary(m_spei_p_xgrowth)
VarCorr(m_spei_p_xgrowth)
# Check assumptions
# install.packages("ggeffects")
library(ggeffects)
library(ggplot2)
pred_int <- ggpredict(m_spei_p_xgrowth, terms = c("Veg_Mass_ln", "Growth_Habit"))
ggplot(pred_int, aes(x = x, y = predicted, color = group)) +
geom_line(size = 1.2) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = group),
alpha = 0.2, color = NA) +
theme_bw() +
labs(x = "Vegetative Biomass (log)",
y = "Predicted Flower Mass (log)",
color = "Growth Habit",
fill = "Growth Habit")
pred_spei <- ggpredict(m_spei_p_xgrowth, terms = "spei_avg")
ggplot(pred_spei, aes(x, predicted)) +
geom_line(size = 1.2) +
geom_ribbon(aes(ymin = conf.low, ymax = conf.high), alpha = 0.2) +
theme_bw() +
labs(x = "SPEI (avg)",
y = "Predicted Flower Mass (log)")
# install.packages("sjPlot")
library(sjPlot)
plot_model(m_spei_p_xgrowth, type = "pred", terms = c("Veg_Mass_ln", "Growth_Habit"))
plot(m_spei_p_xgrowth)        # residual diagnostics
qqnorm(resid(m_spei_p_xgrowth))
qqline(resid(m_spei_p_xgrowth))
log(0.1)
level_order <- c('ANGELO', 'MCL', 'BORR','SEDG','WWP')
SiteColors <-
setNames(c(viridis(5)), levels(c('ANGELO', 'MCL', 'BORR','SEDG','WWP')))
repro_AVEBAR <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "AVEBAR"),]
repro_AVEBAR$Population <- factor(repro_AVEBAR$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_AVEBAR, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Avena barbata") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_AVEBAR.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_AVEBAR))
repro_BRODIA <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "BRODIA"),]
repro_BRODIA$Population <- factor(repro_BRODIA$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_BRODIA, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Bromus diandrus") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_BRODIA.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_BRODIA))
repro_BROHOR <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "BROHOR"),]
repro_BROHOR$Population <- factor(repro_BROHOR$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_BROHOR, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Bromus hordeaceus") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_BROHOR.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_BROHOR))
repro_BROMAD <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "BROMAD"),]
repro_BROMAD$Population <- factor(repro_BROMAD$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_BROMAD, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Bromus madritensis") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_BROMAD.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_BROMAD))
repro_DAUPUS <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "DAUPUS"),]
repro_DAUPUS$Population <- factor(repro_DAUPUS$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_DAUPUS, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Daucus pusillus") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_DAUPUS.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_DAUPUS))
repro_LUPBIC <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "LUPBIC"),]
repro_LUPBIC$Population <- factor(repro_LUPBIC$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_LUPBIC, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Lupinus bicolor") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_LUPBIC.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_LUPBIC))
repro_MADGRA <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "MADGRA"),]
repro_MADGRA$Population <- factor(repro_MADGRA$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_MADGRA, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Madia gracilis") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_MADGRA.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_MADGRA))
repro_MICCAL <- repro_fill_hi_n_narm[which(repro_fill_hi_n_narm$Sp_Code == "MICCAL"),]
repro_MICCAL$Population <- factor(repro_MICCAL$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_MICCAL, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
title = "Micropus californicus") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_MICCAL.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_MADGRA))
# write_csv(repro_fill, "repro_growth_intern.csv")
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status)) +
#geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status, alpha = 0.5)) +
guides(alpha = "none") +
theme_bw() +
geom_smooth(method = "lm", fill = NA) +
theme(
legend.text = element_text(size = 12.5),
legend.title = element_text(size = 12.5),
axis.text=element_text(size=8),
axis.title=element_text(size=12.5),
legend.position = "bottom"
) +
scale_color_manual(values = c("Native" = "#440154FF", "Non-native" = "#5DC863FF")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
color = "")
ggsave("Allom_log_plot_Native.jpg")
unique(repro_fill_hi_n_narm$total_fl_mass_ln)
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Native_Status, data = repro_fill_hi_n_narm))
lmList(total_fl_mass_ln ~ Veg_Mass_ln | Native_Status, data = repro_fill_hi_n_narm)
repro_fill_hi_n_narm$Population <- factor(repro_fill_hi_n_narm$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_abline(intercept = 0, slope = 1) +
# geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_Pop.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_fill_hi_n_narm))
# Population is significant
lmList(total_fl_mass_ln ~ Veg_Mass_ln | Population, data = repro_fill_hi_n_narm)
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status)) +
#geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status, alpha = 0.5)) +
guides(alpha = "none") +
theme_bw() +
geom_smooth(method = "lm", fill = NA) +
theme(
legend.text = element_text(size = 12.5),
legend.title = element_text(size = 12.5),
axis.text=element_text(size=8),
axis.title=element_text(size=12.5),
legend.position = "bottom"
) +
scale_color_manual(values = c("Native" = "#440154FF", "Non-native" = "#5DC863FF")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))",
color = "")
ggsave("Allom_log_plot_Native.jpg")
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Growth_Habit)) +
# geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Growth_Habit, alpha = 0.5)) +
guides(alpha = "none") +
theme_bw() +
geom_smooth(method = "lm", fill = NA) +
theme(
legend.position = "bottom"
) +
scale_color_viridis(discrete=TRUE) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))")
ggsave("Allom_log_plot_GrowthHab.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit, data = repro_fill_hi_n_narm))
lmList(total_fl_mass_ln ~ Veg_Mass_ln | Growth_Habit, data = repro_fill_hi_n_narm)
repro_forb <- repro_fill_hi_n_narm %>%
filter(Growth_Habit == "Forb")
ggplot(repro_forb, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Native_Status, alpha = 0.5)) +
geom_smooth(method = "lm", fill = NA) +
theme_bw() +
scale_color_viridis(discrete=TRUE) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_NativeForb.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Native_Status, data = repro_forb))
lmList(total_fl_mass_ln ~ Veg_Mass_ln | Native_Status, data = repro_forb)
repro_fill_hi_n_narm$Rating<- factor(repro_fill_hi_n_narm$Rating, levels = c("Native", "Non-native","Limited","Moderate","High"))
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Rating)) +
geom_abline(intercept = 0, slope = 1) +
geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Rating, alpha = 0.5)) +
geom_smooth(method = "lm", fill = NA) +
theme_bw() +
scale_color_viridis(discrete=TRUE) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
ggsave("Allom_log_plot_NativeRating.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Rating, data = repro_fill_hi_n_narm))
lmList(total_fl_mass_ln ~ Veg_Mass_ln | Rating, data = repro_fill_hi_n_narm)
head(repro_fill_hi_n_narm)
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln:Population:Native_Status, data = repro_fill_hi_n_narm)
str(mod)
std_err <- summary(mod)$coefficients[, 2]
coefficients(mod)
cf <- coefficients(mod)
str(cf)
cf[1]
cf[2]
repro_summary <- repro_fill_hi_n_narm %>%
group_by(Population,Native_Status) %>%
summarise(slope = NA,
std_err = NA)
## should also include std error
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Native_Status == 'Native',3] <- cf["Veg_Mass_ln:PopulationANGELO:Native_StatusNative"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Native_Status == 'Native',4] <- std_err["Veg_Mass_ln:PopulationANGELO:Native_StatusNative"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Native_Status == 'Non-native',3] <- cf["Veg_Mass_ln:PopulationANGELO:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Native_Status == 'Non-native',4] <- std_err["Veg_Mass_ln:PopulationANGELO:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Native_Status == 'Native',3] <- cf["Veg_Mass_ln:PopulationMCL:Native_StatusNative"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Native_Status == 'Native',4] <- std_err["Veg_Mass_ln:PopulationMCL:Native_StatusNative"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Native_Status == 'Non-native',3] <- cf["Veg_Mass_ln:PopulationMCL:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Native_Status == 'Non-native',4] <- std_err["Veg_Mass_ln:PopulationMCL:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Native_Status == 'Native',3] <- cf["Veg_Mass_ln:PopulationBORR:Native_StatusNative"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Native_Status == 'Native',4] <- std_err["Veg_Mass_ln:PopulationBORR:Native_StatusNative"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Native_Status == 'Non-native',3] <- cf["Veg_Mass_ln:PopulationBORR:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Native_Status == 'Non-native',4] <- std_err["Veg_Mass_ln:PopulationBORR:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Native_Status == 'Native',3] <- cf["Veg_Mass_ln:PopulationSEDG:Native_StatusNative"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Native_Status == 'Native',4] <- std_err["Veg_Mass_ln:PopulationSEDG:Native_StatusNative"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Native_Status == 'Non-native',3] <- cf["Veg_Mass_ln:PopulationSEDG:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Native_Status == 'Non-native',4] <- std_err["Veg_Mass_ln:PopulationSEDG:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Native_Status == 'Native',3] <- cf["Veg_Mass_ln:PopulationWWP:Native_StatusNative"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Native_Status == 'Native',4] <- std_err["Veg_Mass_ln:PopulationWWP:Native_StatusNative"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Native_Status == 'Non-native',3] <- cf["Veg_Mass_ln:PopulationWWP:Native_StatusNon-native"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Native_Status == 'Non-native',4] <- std_err["Veg_Mass_ln:PopulationWWP:Native_StatusNon-native"]
# add std error bars
precip <- read_csv("Site_Precip.csv")
precip$Precip_mm <- as.factor(precip$Precip_mm)
repro_summary_2 <- left_join(repro_summary,precip, by = join_by("Population"))
ggplot(repro_summary_2, aes(x = factor(Precip_mm, level=c('1780','757','603','380','320')), y = slope, fill = Native_Status)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin=slope-std_err, ymax=slope+std_err), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_bw() +
theme(
legend.text = element_text(size = 25),
axis.text=element_text(size=16),
axis.title=element_text(size=25),
legend.position = "bottom"
) +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#5DC863FF")) +
labs(x = "Average Annual Precipitation (mm)",
y = "Slope of log(V) and log(R)",
fill = "")
ggsave("Slope_Pop_Native.jpg")
# It should align with this graph but it doesn't
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population, linetype = Native_Status)) +
geom_abline(intercept = 0, slope = 1) +
# geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
scale_linetype_manual(values = c("Native" = "dashed", "Non-native" = "solid")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
# These don't line up, doube check slope allocation, probs better to use emmeans
head(repro_fill_hi_n_narm)
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Growth_Habit, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln:Population:Growth_Habit, data = repro_fill_hi_n_narm)
str(mod)
std_err <- summary(mod)$coefficients[, 2]
coefficients(mod)
cf <- coefficients(mod)
str(cf)
cf[1]
cf[2]
repro_summary <- repro_fill_hi_n_narm %>%
group_by(Population,Growth_Habit) %>%
summarise(slope = NA,
std_err = NA)
## should also include std error
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Growth_Habit == 'Forb',3] <- cf["Veg_Mass_ln:PopulationANGELO:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Growth_Habit == 'Forb',4] <- std_err["Veg_Mass_ln:PopulationANGELO:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Growth_Habit == 'Grass',3] <- cf["Veg_Mass_ln:PopulationANGELO:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'ANGELO' & repro_summary$Growth_Habit == 'Grass',4] <- std_err["Veg_Mass_ln:PopulationANGELO:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Growth_Habit == 'Forb',3] <- cf["Veg_Mass_ln:PopulationMCL:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Growth_Habit == 'Forb',4] <- std_err["Veg_Mass_ln:PopulationMCL:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Growth_Habit == 'Grass',3] <- cf["Veg_Mass_ln:PopulationMCL:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'MCL' & repro_summary$Growth_Habit == 'Grass',4] <- std_err["Veg_Mass_ln:PopulationMCL:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Growth_Habit == 'Forb',3] <- cf["Veg_Mass_ln:PopulationBORR:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Growth_Habit == 'Forb',4] <- std_err["Veg_Mass_ln:PopulationBORR:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Growth_Habit == 'Grass',3] <- cf["Veg_Mass_ln:PopulationBORR:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'BORR' & repro_summary$Growth_Habit == 'Grass',4] <- std_err["Veg_Mass_ln:PopulationBORR:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Growth_Habit == 'Forb',3] <- cf["Veg_Mass_ln:PopulationSEDG:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Growth_Habit == 'Forb',4] <- std_err["Veg_Mass_ln:PopulationSEDG:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Growth_Habit == 'Grass',3] <- cf["Veg_Mass_ln:PopulationSEDG:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'SEDG' & repro_summary$Growth_Habit == 'Grass',4] <- std_err["Veg_Mass_ln:PopulationSEDG:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Growth_Habit == 'Forb',3] <- cf["Veg_Mass_ln:PopulationWWP:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Growth_Habit == 'Forb',4] <- std_err["Veg_Mass_ln:PopulationWWP:Growth_HabitForb"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Growth_Habit == 'Grass',3] <- cf["Veg_Mass_ln:PopulationWWP:Growth_HabitGrass"]
repro_summary[repro_summary$Population == 'WWP' & repro_summary$Growth_Habit == 'Grass',4] <- std_err["Veg_Mass_ln:PopulationWWP:Growth_HabitGrass"]
# add std error bars
precip <- read_csv("Site_Precip.csv")
precip$Precip_mm <- as.factor(precip$Precip_mm)
repro_summary_2 <- left_join(repro_summary,precip, by = join_by("Population"))
ggplot(repro_summary_2, aes(x = factor(Precip_mm, level=c('1780','757','603','380','320')), y = slope, fill = Growth_Habit)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_errorbar(aes(ymin=slope-std_err, ymax=slope+std_err), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_bw() +
theme(
legend.text = element_text(size = 25),
axis.text=element_text(size=16),
axis.title=element_text(size=25),
legend.position = "bottom"
) +
scale_fill_manual(values = c("Forb" = "#440154FF", "Grass" = "#5DC863FF")) +
labs(x = "Average Annual Precipitation (mm)",
y = "Slope of log(V) and log(R)",
fill = "")
ggsave("Slope_Pop_Growth.jpg")
ggplot(repro_fill_hi_n_narm, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population, linetype = Growth_Habit)) +
geom_abline(intercept = 0, slope = 1) +
# geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Population)) +
geom_smooth(method = "lm", fill = NA) +
scale_color_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
theme_bw() +
scale_linetype_manual(values = c("Forb" = "dashed", "Grass" = "solid")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
# These don't line up, double check slope allocation, probs better to use emmeans
precip$Precip_mm <- as.numeric(precip$Precip_mm)
repro_fill_hi_n_narm <- left_join(repro_fill_hi_n_narm,precip, by = join_by("Population"))
m0 <- glm(total_fl_mass_ln ~ 1, family = gaussian, data = repro_fill_hi_n_narm)
m1 <- glm(total_fl_mass_ln ~ Veg_Mass_ln, family = gaussian, data = repro_fill_hi_n_narm)
m2 <- glmer(total_fl_mass_ln ~ Veg_Mass_ln + (1|Block), family = gaussian, data = repro_fill_hi_n_narm)
ICtab(m0,m1,m2)
m_v_p <- glm(total_fl_mass_ln ~ Veg_Mass_ln + Population, family = gaussian, data = repro_fill_hi_n_narm)
m_vxp <- glm(total_fl_mass_ln ~ Veg_Mass_ln*Population, family = gaussian, data = repro_fill_hi_n_narm)
m_v_pr <- glm(total_fl_mass_ln ~ Veg_Mass_ln + Precip_mm, family = gaussian, data = repro_fill_hi_n_narm)
