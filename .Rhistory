labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9))
# Consider log -scaling to make more digestible
ggsave("Allom_log_plot.jpg")
# Can I put the slope next to each species name
# test to see if slopes are significantly different from 0 and form each other
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Scientific_Name, data = repro_fill_hi_n_narm))
mod <- lmList(total_fl_mass_ln ~ Veg_Mass_ln | Scientific_Name, data = repro_fill_hi_n_narm)
# Make plot larger/wider
mod <- as.data.frame(summary(mod)$coefficients)
sp_list <- sort(unique(repro_fill_hi_n_narm$Scientific_Name))
mod$Scientific_Name <- sort(unique(repro_fill_hi_n_narm$Scientific_Name))
new_spp <- left_join(spp,mod,by=join_by("Scientific_Name")) %>%
select(
Scientific_Name,
Estimate.Veg_Mass_ln
)
repro_slopes <- left_join(repro_fill_hi_n_narm,new_spp, by=join_by("Scientific_Name")) %>%
mutate(
Species = paste0(Scientific_Name,
" ",
substr(Estimate.Veg_Mass_ln,1,4)
)
)
ggplot(repro_slopes, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Species
# , linetype = Native_Status
)) +
geom_abline(intercept = 0, slope = 1) +
#geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Species)) +
geom_smooth(method = "lm", fill = NA, size = 0.5) +
# scale_color_viridis(discrete=TRUE) +
theme_bw() +
scale_linetype_manual(values = c("Native" = "dashed", "Non-native" = "solid")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=9),
legend.key.size = unit(0.5, "cm"),
legend.text= element_text(size = 9),
legend.title = element_text(size = 9),
legend.position = "bottom")
ggsave("Allom_log_plot_slopes.jpg", height=9, width = 9)
# These aren't actually the correct slopes, the correct slopes come from emtrends
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Scientific_Name, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Scientific_Name,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Scientific_Name, var = "Veg_Mass_ln")
slopes
test_slopes_vs1 <- test(slopes, null = 1)
test_slopes_vs1[which(test_slopes_vs1$p.value<0.05),]
pairs(slopes)
# anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Sp_Code, data = repro_fill_hi_n))
options(max.print=2000)
pairs(slopes, adjust = "tukey")
repro_dif <- repro_slopes %>%
filter(
Scientific_Name %in% c("Amsinckia menziesii","Avena barbata","Bromus diandrus","Bromus hordeaceaus"))
ggplot(repro_dif, aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Species
# , linetype = Native_Status
)) +
geom_abline(intercept = 0, slope = 1) +
#geom_point(aes(x = Veg_Mass_ln, y = total_fl_mass_ln, color = Species)) +
geom_smooth(method = "lm", fill = NA, size = 1) +
# scale_color_viridis(discrete=TRUE) +
theme_bw() +
scale_linetype_manual(values = c("Native" = "dashed", "Non-native" = "solid")) +
labs(x = "ln(Vegetative Biomass (g))",
y = "ln(Reproductive Biomass (g))") +
theme(axis.text.x = element_text(size=15),
legend.text= element_text(size = 15),
legend.title = element_text(size = 15),
legend.position = "bottom")
ggsave("Allom_log_plot_slopes_1.jpg", height=9, width = 15)
slopes <- emtrends(mod, ~ Scientific_Name, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes) %>%
arrange(desc(Veg_Mass_ln.trend))
test_slopes_vs1 <- test(slopes, null = 1)
test_slopes_vs1[which(test_slopes_vs1$p.value<0.05),]
level_order <- unique(as.factor(slopes.df$Scientific_Name))
# Graph a bar plot of each species in order of slope with standard error bars and line at 1
#("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
# Make species names italic and 45 degrees
# Maybe make bar colors if significant
sigs <- test_slopes_vs1[which(test_slopes_vs1$p.value<0.05),1]
slopes.df$columnColor <- "N.S."
slopes.df$columnColor[which(slopes.df$Scientific_Name == sigs[1])] <- "p-value < 0.05"
slopes.df$columnColor[which(slopes.df$Scientific_Name == sigs[2])] <- "p-value < 0.05"
slopes.df$columnColor[which(slopes.df$Scientific_Name == sigs[3])] <- "p-value < 0.05"
slopes.df$columnColor[which(slopes.df$Scientific_Name == sigs[4])] <- "p-value < 0.05"
ggplot(slopes.df, aes(x = factor(Scientific_Name, level=c(level_order)), y = Veg_Mass_ln.trend
, fill = columnColor
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("N.S." = "#21908CFF", "p-value < 0.05" = "#440154FF")) +
theme(
axis.text.x = element_text(face = "italic", angle = 45, vjust = 1, hjust = 1),
legend.position = c(0.75, 0.95),
#legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
plot.margin = unit(c(0.25,0.25,0.25,0.75), "cm")
) +
guides(fill=guide_legend(ncol=2)) +
labs(x = "Species",
y = "VR Slope",
fill = "")
ggsave("slopes_spp.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Native_Status,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Native_Status, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes) %>%
arrange(desc(Veg_Mass_ln.trend))
test_slopes_vs1 <- test(slopes, null = 1)
ggplot(slopes.df, aes(x = Native_Status, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("N.S." = "#21908CFF", "p-value < 0.05" = "#440154FF")) +
theme(
axis.text.x = element_text(face = "italic", angle = 45, vjust = 1, hjust = 1),
legend.position = c(0.75, 0.95),
#legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
plot.margin = unit(c(0.25,0.25,0.25,0.75), "cm")
) +
guides(fill=guide_legend(ncol=2)) +
labs(x = "Species",
y = "VR Slope",
fill = "")
ggplot(slopes.df, aes(x = Native_Status, y = Veg_Mass_ln.trend,
fill = "#21908CFF"
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
ggplot(slopes.df, aes(x = Native_Status, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
ggsave("slopes_native.jpg")
ggplot(slopes.df, aes(x = Native_Status, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
ggsave("slopes_native.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Rating, data = repro_fill_hi_n_narm))
slopes <- emtrends(mod, ~ Rating, var = "Veg_Mass_ln")
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes) %>%
arrange(desc(Veg_Mass_ln.trend))
ggplot(slopes.df, aes(x = Rating, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
repro_fill_hi_n_narm$Rating<- factor(repro_fill_hi_n_narm$Rating, levels = c("Native", "Non-native","Limited","Moderate","High"))
ggplot(slopes.df, aes(x = Rating, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Rating, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Rating, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Native Status",
y = "VR Slope",
fill = "")
ggsave("slopes_rating.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Growth_Habit,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Growth_Habit, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend
)) +
geom_bar(position = position_dodge(), stat = "identity", fill = "#21908CFF") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggsave("slopes_growth.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Growth_Habit * Native_Status,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Growth_Habit*Native_Status, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend,
fill = Native_Status
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values=c("#21908CFF","#440154FF")) +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggsave("slopes_growthxnative.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit*Rating, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Growth_Habit * Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Growth_Habit*Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend,
fill = Native_Status
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#3B528BFF", "Limited" = "#21908CFF", "Moderate" = "#5DC863FF", "High" = "#FDE725FF")) +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend,
fill = Rating
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#3B528BFF", "Limited" = "#21908CFF", "Moderate" = "#5DC863FF", "High" = "#FDE725FF")) +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Growth_Habit * Native_Status,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Growth_Habit*Native_Status, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend,
fill = Native_Status
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#21908CFF")) +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggsave("slopes_growthxnative.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Growth_Habit*Rating, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Growth_Habit * Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Growth_Habit*Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Growth_Habit, y = Veg_Mass_ln.trend,
fill = Rating
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#3B528BFF", "Limited" = "#21908CFF", "Moderate" = "#5DC863FF", "High" = "#FDE725FF")) +
labs(x = "Growth Habit",
y = "VR Slope",
fill = "")
ggsave("slopes_growthxrating.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour='black', alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population * Native_Status,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Native_Status, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Native_Status
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#21908CFF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_popxnative.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Rating, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Rating
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#3B528BFF", "Limited" = "#21908CFF", "Moderate" = "#5DC863FF", "High" = "#FDE725FF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_popxrating.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Growth_Habit, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population * Growth_Habit,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Growth_Habit, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Growth_Habit
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Forb" = "#440154FF", "Grass" = "#21908CFF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
repro_fill_hi_n_narm$Population <- factor(repro_fill_hi_n_narm$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
repro_fill_hi_n_narm$Population <- factor(repro_fill_hi_n_narm$Population, levels = c("ANGELO", "MCL", "BORR","SEDG","WWP"))
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour='black', alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("ANGELO" = "#440154FF", "MCL" = "#3B528BFF", "BORR" = "#21908CFF", "SEDG" = "#5DC863FF", "WWP" = "#FDE725FF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_population.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Native_Status, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population * Native_Status,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Native_Status, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Native_Status
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#21908CFF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_popxnative.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Rating, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Rating,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Rating, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Rating
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Native" = "#440154FF", "Non-native" = "#3B528BFF", "Limited" = "#21908CFF", "Moderate" = "#5DC863FF", "High" = "#FDE725FF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_popxrating.jpg")
anova(lm(total_fl_mass_ln ~ Veg_Mass_ln*Population*Growth_Habit, data = repro_fill_hi_n_narm))
mod <- lm(total_fl_mass_ln ~ Veg_Mass_ln * Population * Growth_Habit,
data = repro_fill_hi_n_narm)
slopes <- emtrends(mod, ~ Population*Growth_Habit, var = "Veg_Mass_ln")
slopes
slopes.df <- summary(slopes)
ggplot(slopes.df, aes(x = Population, y = Veg_Mass_ln.trend,
fill = Growth_Habit
)) +
geom_bar(position = position_dodge(), stat = "identity") +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin=Veg_Mass_ln.trend-SE, ymax=Veg_Mass_ln.trend+SE), width=0.3, colour="#FDE725FF", alpha=0.9, size=1.3, position = position_dodge(0.9)) +
theme_classic() +
scale_fill_manual(values = c("Forb" = "#440154FF", "Grass" = "#21908CFF")) +
labs(x = "Population",
y = "VR Slope",
fill = "")
ggsave("slopes_popxgrowth.jpg")
str(repro_fill_hi_n_narm)
# Lastly add in precipitation
precip <- read_csv("Site_Precip.csv")
repro_fill_hi_n_narm_1 <- repro_fill_hi_n_narm
repro_fill_hi_n_narm <- left_join(repro_fill_hi_n_narm_1,precip, by=join_by("Population"))
View(repro_fill_hi_n_narm)
str(repro_fill_hi_n_narm)
# Create ratio of fl to v
repro_fill_hi_n_narm$VR <- repro_fill_hi_n_narm$total_fl_mass_ln/repro_fill_hi_n_narm$Veg_Mass_ln
str(repro_fill_hi_n_narm)
m0 <- glm(VR ~ 1, family = gaussian, data = repro_fill_hi_n_narm)
m0 <- glm(VR ~ 1, family = gaussian, data = repro_fill_hi_n_narm)
m1 <- glmer(VR ~ 1 + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m2 <- glmer(VR ~ 1 + (1|Block/Shelter/Plot), family = gaussian, data = repro_fill_hi_n_narm)
m3 <- glmer(VR ~ 1 + (1|Block) + (1|Treatment), family = gaussian, data = repro_fill_hi_n_narm)
m4 <- glmer(VR ~ 1 + (1|Block/Shelter/Plot) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
ICtab(m0,m1,m2,m3,m4)
m5 <- glmer(VR ~ 1 + (1|Block) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
ICtab(m0,m1,m2,m3,m4,m5)
m0 <- glm(VR ~ 1, family = gaussian, data = repro_fill_hi_n_narm)
m1 <- glmer(VR ~ 1 + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m2 <- glmer(VR ~ 1 + (1|Block/Shelter/Plot), family = gaussian, data = repro_fill_hi_n_narm)
m3 <- glmer(VR ~ 1 + (1|Block) + (1|Treatment), family = gaussian, data = repro_fill_hi_n_narm)
m4 <- glmer(VR ~ 1 + (1|Block/Shelter/Plot) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m5 <- glmer(VR ~ 1 + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m6 <- glmer(VR ~ 1 + (1|Block) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
ICtab(m0,m1,m2,m3,m4,m5,m6)
View(repro_fill_hi_n_narm_1)
View(repro_fill_hi_n_narm)
m5 <- glmer(VR ~ 1 + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_native <- glmer(VR ~ Native_Status + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_rating <- glmer(VR ~ Rating + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_growth <- glmer(VR ~ Growth_Habit + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_precip <- glmer(VR ~ Precip_mm + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_pdif <- glmer(VR ~ precip_dif + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_nativexgrowth <- glmer(VR ~ Native_Status*Growth_Habit + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_ratingxgrowth <- glmer(VR ~ Rating*Growth_Habit + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_nativexpop <- glmer(VR ~ Native*Population + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_nativexpop <- glmer(VR ~ Native_Status*Population + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_ratingxpop <- glmer(VR ~ Rating*Population + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_growthxpop <- glmer(VR ~ Growth_Habit*Population + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_nativexprecip <- glmer(VR ~ Native_Status*Precip_mm + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_ratingxprecip <- glmer(VR ~ Rating*Precip_mm + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
m_growthxprecip <- glmer(VR ~ Growth_Habit*Precip_mm + (1|Block) + (1|Treatment) + (1|Scientific_Name), family = gaussian, data = repro_fill_hi_n_narm)
ICtab(m5
,m_native
,m_rating
,m_growth
,m_growthxpop
,m_growthxprecip
,m_nativexgrowth
,m_nativexpop
,m_nativexprecip
,m_pdif
,m_precip
,m_ratingxgrowth
,m_ratingxpop
,m_ratingxprecip)
lrtest(m_ratingxpop, m5)
Anova(m_ratingxpop)
summary(m_ratingxpop)
